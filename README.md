# mini-react 第八天

useEffect的使用上给我的感觉很像是vue中watch，初始时会执行一次更像Vue3中watchEffect。实现上，还是在当前的fiber上绑定effectHook对象，其中存储callback和deps数据。作为监听函数的话（姑且这么理解），执行的时机一定是在页面渲染完成之后，也就是commitWork函数之后。从根节点变量所有字节点，找到节点中存在的effectHook进行处理，这和commitWork中实现思路类似。而多个useEffect调用会存在后面的覆盖前面的，就需要effectHooks数组进行处理，这又和useState中实现的stateHooks类似。

cleanup的实现，明白了其使用方式明确实现需求，实现起来还算简单。执行时机先于useEffect中的callback，拿到callback执行结果，也就是cleanup的待执行函数，还是通过根节点循环变量所有节点，处理老节点中的cleanup。

